# Парсер agregatoreat.ru v2

## Установка зависимостей
Установка зависимостей выполняется автоматически при первом запуске. 
Если возникла ошибка с зависимостями - удалите папку venv и запустите скрипт run.bat еще раз.

## Запуск
Для запуска, воспользуйтесь файлом run.bat, или выполните следующие команды:
```commandline
call venv\Scripts\activate.bat
python main.py
```

## Обзор кода

### main.py
Основной рабочий файл, содержит класс EAT(), реализующий http client для взаимодействия с системой ЕАТ. 
Рабочий цикл:
1. Инициализация свойств из конфига,
2. Бесконечная отправка запроса к JSON API сервису для получения существующих закупок,
3. Отправка запроса на XML API сервис для получения параметров закупки,
4. Отправка запроса на XML API сервис для создания предложения 

### config.py
Настройки парсера, представлены в json формате.

#### Общие
Общие настройки программы
1. Выводить в консоль отладочную инфорацию? - Да\Нет

#### ЕАТ
Основные параметры для подстановки в запросы
1. Токен - токен, полученный в личном кабинет (Личный кабинет Поставщика -> Информационные системы -> Токены)
2. ИНН - ИНН, по которому ищем закупки
3. Ключевая фраза - фраза, по которой ищем закупки
4. Исключаемые процедуры - список номеров игнорируемых процедур
5. НДС - ставка НДС (Не облагается, либо процент)
6. Ставка - цена каждой позиции
7. Название файла - название файла, которое будет отображаться у создателя закупки. Обязательно должно содержать разрешение файла
8. Ссылка на файл - ссылка на файл внутри системы, либо в каком-либо внешнем источнике

#### Параметры поставщика
Общие параметры поставщика, поставляются в предложение к закупке
1. Номер системы - индивидуальный номер, установленный поставщику при регистрации
2. Название компании
3. ИНН
4. КПП
5. ОГРН
6. Адрес
7. Email
8. Номер телефона

#### Переменные
Параметры в этой графе используются для генерации заявок, крайне не рекомендуется менять без причины
1. UID последнего запроса - уникальный идентификатор, который будет использоваться для следующей заявки
2. Основная часть стартового Request UID - стартовая часть id запроса, используется для формирования корректного аттрбиута в XML
3. Расчетная часть стартового Request UID - часть id запроса, изменяемая при создании нового запроса
4. URL JSON API списка закупок - ссылка на JSON API эндпоинт для выгрузки закупок по параметрам
5. URL XML API получения информации о закупке - ссылка на XML API эндпоинт для получения информации о закупке по номеру
6. URL XML API подтверждения запроса - ссылка на XML API с получением результата запроса
7. URL XML API создание предложения - ссылка на XML API на создание предложения
8. XML файл с запросом на получение информации о закупке
9. XML файл с запросом на получение результата
10. XML файл с запросом на добавление предложения
11. XML файл с предложением по позиции